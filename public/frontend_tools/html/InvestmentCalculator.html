<script type="text/javascript-lazy">
    var app = angular.module('ctw');
    app.controllerProvider.register('toolController', function ($scope) {
        var initial = {
            principal: undefined,
            years: undefined,
            interest: undefined,
            //completely optional:
            monthly: undefined,
            interval: undefined,

            result: undefined,
            error: undefined
        }
        $scope.investment = angular.copy(initial);

        $scope.calculate = function () {
            var scope = $scope.investment;
            if (validateDecimal(scope.principal) && validateDecimal(scope.years) && validateDecimal(scope.interest)) {

                scope.result = {fv: undefined, fvA: undefined};

                var interval = 1;
                if (validateDecimal(scope.interval)) {
                    interval = scope.interval;
                }

                var pv = scope.principal;
                var r = scope.interest / interval / 100;
                var n = scope.years * interval;

                var fv = pv * Math.pow(1 + r, n);
                scope.result.fv = fv.toFixed(2);

                if (validateDecimal(scope.monthly)) {
                    var p = scope.monthly * 12 / interval;

                    var fvA = p * ((Math.pow(1 + r, n) - 1) / r);
                    scope.result.fvA = fvA.toFixed(2);
                }
            } else {
                scope.error = 'Missing or invalid Input';
                return;
            }
        }
        $scope.reset = function () {
            $scope.investment = angular.copy(initial);
        }


        var validateDecimal = function (decimal) {
            decimal = parseFloat(decimal);
            return angular.isNumber(decimal) && isFinite(decimal);
        }
    });
</script>
<style>
    #form-wrapper {
        text-align: center;
    }
</style>
<h1>Investment & Savings Calculator</h1>
<div ng-controller="toolController">
    <div id="form-wrapper">
        <form class="pure-form pure-form-aligned" novalidate>
            <fieldset>
                <legend>Fill out the form and click calculate</legend>
                <div class="pure-control-group">
                    <label for="principal" class="label">Initial Amount</label>
                    <input id="principal" type="number" step="any" placeholder="amount"
                           ng-model="investment.principal"/>
                </div>
                <div class="pure-control-group">
                    <label for="years" class="label">Years</label>
                    <input id="years" type="number" step="any" placeholder="years" ng-model="investment.years"/>
                </div>
                <div class="pure-control-group">
                    <label for="interest" class="label">Interest Rate (&percnt;)</label>
                    <input id="interest" type="number" step="any" placeholder="%" ng-model="investment.interest"/>
                </div>
            </fieldset>
            <fieldset>
                <legend>Additional information (optional)</legend>
                <div class="pure-control-group">
                    <label for="monthly" class="label">Monthly Addition</label>
                    <input id="monthly" type="number" step="any" placeholder="amount (0)"
                           ng-model="investment.monthly"/>
                </div>
                <div class="pure-control-group">
                    <label for="compound" class="label">Compound Interest (times annually)</label>
                    <input id="compound" type="number" step="any" placeholder="annually (1)"
                           ng-model="investment.interval"/>
                </div>

                <div>
                    <button class="pure-button pure-button-primary" ng-click="calculate()">Calculate
                    </button>
                    <button class="pure-button" type="reset" ng-click="reset()">Clear
                    </button>
                </div>
                <div class="alert" ng-show="investment.error !== undefined">
                    <div class="alert_inner">
                        <div class="alert_text">{{investment.error}}</div>
                        <div class="alert_dismiss" ng-click="investment.error = undefined">&times;</div>
                    </div>
                </div>
            </fieldset>
        </form>
    </div>
    <div ng-show="investment.result !== undefined">
        <p> The Future Value of your Investment will be <b>{{(investment.result.fv*1 + (investment.result.fvA || 0)*1).toFixed(2)}}</b>.</p>
        <p ng-show="investment.result.fvA"><b>{{(investment.result.fv*1).toFixed(2)}}</b> of that comes from your initial deposit.</p>
        <p ng-show="investment.result.fvA"><b>{{(investment.result.fvA*1).toFixed(2)}}</b> of that comes from your monthly deposits.</p>
    </div>
</div>
<hr/>
<div class="pure-g">
    <div class="pure-u-1 pure-u-md-1-3 text">
        <h4>Keywords</h4>

        <p>
            Investment, Savings, Future Value, ROI, compound interest
        </p>
    </div>
    <div class="pure-u-1 pure-u-md-1-3 text">
        <h4>Lorem Ipsum</h4>

        <p>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et
            dolore magna aliqua. Ut enim ad minim veniam.
        </p>
    </div>
    <div class="pure-u-1 pure-u-md-1-3 text">
        <h4>Lorem Ipsum</h4>

        <p>
            Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et
            dolore magna aliqua. Ut enim ad minim veniam.
        </p>
    </div>
</div>
</div>


